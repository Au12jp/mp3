"use strict";(()=>{var q=Object.defineProperty;var x=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,tt=Object.prototype.propertyIsEnumerable;var B=e=>{throw TypeError(e)};var et=(e,t,r)=>t in e?q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var C=(e,t)=>{var r={};for(var o in e)Q.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(e!=null&&x)for(var o of x(e))t.indexOf(o)<0&&tt.call(e,o)&&(r[o]=e[o]);return r};var m=(e,t)=>()=>(e&&(t=e(e=0)),t);var rt=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var c=(e,t,r)=>et(e,typeof t!="symbol"?t+"":t,r),M=(e,t,r)=>t.has(e)||B("Cannot "+r);var n=(e,t,r)=>(M(e,t,"read from private field"),r?r.call(e):t.get(e)),u=(e,t,r)=>t.has(e)?B("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),_=(e,t,r,o)=>(M(e,t,"write to private field"),o?o.call(e,r):t.set(e,r),r);var L=(e,t,r)=>new Promise((o,a)=>{var i=E=>{try{f(r.next(E))}catch(I){a(I)}},R=E=>{try{f(r.throw(E))}catch(I){a(I)}},f=E=>E.done?o(E.value):Promise.resolve(E.value).then(i,R);f((r=r.apply(e,t)).next())});var ot,ft,s,S=m(()=>{ot="0.12.6",ft=`https://unpkg.com/@ffmpeg/core@${ot}/dist/umd/ffmpeg-core.js`;(function(e){e.LOAD="LOAD",e.EXEC="EXEC",e.WRITE_FILE="WRITE_FILE",e.READ_FILE="READ_FILE",e.DELETE_FILE="DELETE_FILE",e.RENAME="RENAME",e.CREATE_DIR="CREATE_DIR",e.LIST_DIR="LIST_DIR",e.DELETE_DIR="DELETE_DIR",e.ERROR="ERROR",e.DOWNLOAD="DOWNLOAD",e.PROGRESS="PROGRESS",e.LOG="LOG",e.MOUNT="MOUNT",e.UNMOUNT="UNMOUNT"})(s||(s={}))});var k,P=m(()=>{k=(()=>{let e=0;return()=>e++})()});var pt,v,j,mt,W=m(()=>{pt=new Error("unknown message type"),v=new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),j=new Error("called FFmpeg.terminate()"),mt=new Error("failed to import ffmpeg-core.js")});var H,l,h,p,w,O,A,d,g,F=m(()=>{S();P();W();H={},g=class{constructor(){u(this,l,null);u(this,h,{});u(this,p,{});u(this,w,[]);u(this,O,[]);c(this,"loaded",!1);u(this,A,()=>{n(this,l)&&(n(this,l).onmessage=({data:{id:t,type:r,data:o}})=>{switch(r){case s.LOAD:this.loaded=!0,n(this,h)[t](o);break;case s.MOUNT:case s.UNMOUNT:case s.EXEC:case s.WRITE_FILE:case s.READ_FILE:case s.DELETE_FILE:case s.RENAME:case s.CREATE_DIR:case s.LIST_DIR:case s.DELETE_DIR:n(this,h)[t](o);break;case s.LOG:n(this,w).forEach(a=>a(o));break;case s.PROGRESS:n(this,O).forEach(a=>a(o));break;case s.ERROR:n(this,p)[t](o);break}delete n(this,h)[t],delete n(this,p)[t]})});u(this,d,({type:t,data:r},o=[],a)=>n(this,l)?new Promise((i,R)=>{let f=k();n(this,l)&&n(this,l).postMessage({id:f,type:t,data:r},o),n(this,h)[f]=i,n(this,p)[f]=R,a==null||a.addEventListener("abort",()=>{R(new DOMException(`Message # ${f} was aborted`,"AbortError"))},{once:!0})}):Promise.reject(v));c(this,"load",(a={},{signal:o}={})=>{var i=a,{classWorkerURL:t}=i,r=C(i,["classWorkerURL"]);return n(this,l)||(_(this,l,t?new Worker(new URL(t,H.url),{type:"module"}):new Worker(new URL("./worker.js",H.url),{type:"module"})),n(this,A).call(this)),n(this,d).call(this,{type:s.LOAD,data:r},void 0,o)});c(this,"exec",(t,r=-1,{signal:o}={})=>n(this,d).call(this,{type:s.EXEC,data:{args:t,timeout:r}},void 0,o));c(this,"terminate",()=>{let t=Object.keys(n(this,p));for(let r of t)n(this,p)[r](j),delete n(this,p)[r],delete n(this,h)[r];n(this,l)&&(n(this,l).terminate(),_(this,l,null),this.loaded=!1)});c(this,"writeFile",(t,r,{signal:o}={})=>{let a=[];return r instanceof Uint8Array&&a.push(r.buffer),n(this,d).call(this,{type:s.WRITE_FILE,data:{path:t,data:r}},a,o)});c(this,"mount",(t,r,o)=>{let a=[];return n(this,d).call(this,{type:s.MOUNT,data:{fsType:t,options:r,mountPoint:o}},a)});c(this,"unmount",t=>{let r=[];return n(this,d).call(this,{type:s.UNMOUNT,data:{mountPoint:t}},r)});c(this,"readFile",(t,r="binary",{signal:o}={})=>n(this,d).call(this,{type:s.READ_FILE,data:{path:t,encoding:r}},void 0,o));c(this,"deleteFile",(t,{signal:r}={})=>n(this,d).call(this,{type:s.DELETE_FILE,data:{path:t}},void 0,r));c(this,"rename",(t,r,{signal:o}={})=>n(this,d).call(this,{type:s.RENAME,data:{oldPath:t,newPath:r}},void 0,o));c(this,"createDir",(t,{signal:r}={})=>n(this,d).call(this,{type:s.CREATE_DIR,data:{path:t}},void 0,r));c(this,"listDir",(t,{signal:r}={})=>n(this,d).call(this,{type:s.LIST_DIR,data:{path:t}},void 0,r));c(this,"deleteDir",(t,{signal:r}={})=>n(this,d).call(this,{type:s.DELETE_DIR,data:{path:t}},void 0,r))}on(t,r){t==="log"?n(this,w).push(r):t==="progress"&&n(this,O).push(r)}off(t,r){t==="log"?_(this,w,n(this,w).filter(o=>o!==r)):t==="progress"&&_(this,O,n(this,O).filter(o=>o!==r))}};l=new WeakMap,h=new WeakMap,p=new WeakMap,w=new WeakMap,O=new WeakMap,A=new WeakMap,d=new WeakMap});var G=m(()=>{F()});var $,V,Y=m(()=>{$=new Error("failed to get response body reader"),V=new Error("failed to complete download")});var X,z=m(()=>{X="Content-Length"});var nt,J,at,y,K=m(()=>{Y();z();nt=e=>new Promise((t,r)=>{let o=new FileReader;o.onload=()=>{let{result:a}=o;a instanceof ArrayBuffer?t(new Uint8Array(a)):t(new Uint8Array)},o.onerror=a=>{var i,R;r(Error(`File could not be read! Code=${((R=(i=a==null?void 0:a.target)==null?void 0:i.error)==null?void 0:R.code)||-1}`))},o.readAsArrayBuffer(e)}),J=e=>L(void 0,null,function*(){let t;if(typeof e=="string")/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(e)?t=atob(e.split(",")[1]).split("").map(r=>r.charCodeAt(0)):t=yield(yield fetch(e)).arrayBuffer();else if(e instanceof URL)t=yield(yield fetch(e)).arrayBuffer();else if(e instanceof File||e instanceof Blob)t=yield nt(e);else return new Uint8Array;return new Uint8Array(t)}),at=(e,t)=>L(void 0,null,function*(){var a;let r=yield fetch(e),o;try{let i=parseInt(r.headers.get(X)||"-1"),R=(a=r.body)==null?void 0:a.getReader();if(!R)throw $;let f=[],E=0;for(;;){let{done:D,value:U}=yield R.read(),T=U?U.length:0;if(D){if(i!=-1&&i!==E)throw V;t&&t({url:e,total:i,received:E,delta:T,done:D});break}f.push(U),E+=T,t&&t({url:e,total:i,received:E,delta:T,done:D})}let I=new Uint8Array(E),b=0;for(let D of f)I.set(D,b),b+=D.length;o=I.buffer}catch(i){console.log("failed to send download progress event: ",i),o=yield r.arrayBuffer(),t&&t({url:e,total:o.byteLength,received:o.byteLength,delta:0,done:!0})}return o}),y=(e,t,r=!1,o)=>L(void 0,null,function*(){let a=r?yield at(e,o):yield(yield fetch(e)).arrayBuffer(),i=new Blob([a],{type:t});return URL.createObjectURL(i)})});var ct=rt(Z=>{G();K();var N=document.getElementById("fileInput"),st=document.getElementById("trimButton"),it=document.getElementById("videoOutput");st.addEventListener("click",()=>L(Z,null,function*(){if(!N.files||N.files.length===0){alert("\u307E\u305A\u52D5\u753B\u30D5\u30A1\u30A4\u30EB\u3092\u9078\u629E\u3057\u3066\u304F\u3060\u3055\u3044\u3002");return}let e=document.getElementById("start").value,t=document.getElementById("end").value,r=yield Et(N.files[0],e,t);r&&(it.src=r)}));function Et(e,t,r){return L(this,null,function*(){let o=new g,a="https://unpkg.com/@ffmpeg/core-mt@0.12.6/dist/esm",i={coreURL:yield y(`${a}/ffmpeg-core.js`,"text/javascript"),wasmURL:yield y(`${a}/ffmpeg-core.wasm`,"application/wasm"),workerURL:yield y(`${a}/ffmpeg-core.worker.js`,"text/javascript")};yield o.load(i),console.warn("ffmpeg loaded"),yield o.writeFile("input.mp4",yield J(e));let R=(parseInt(r)-parseInt(t)).toString();yield o.exec(["-i","input.mp4","-ss",t,"-t",R,"output.mp4"]);let f=yield o.readFile("output.mp4"),E=new Blob([new Uint8Array(f)],{type:"video/mp4"});return URL.createObjectURL(E)})}});ct();})();
//# sourceMappingURL=main.js.map
