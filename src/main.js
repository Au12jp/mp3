"use strict";(()=>{var tt=Object.defineProperty;var C=Object.getOwnPropertySymbols;var et=Object.prototype.hasOwnProperty,rt=Object.prototype.propertyIsEnumerable;var M=e=>{throw TypeError(e)};var ot=(e,t,r)=>t in e?tt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var S=(e,t)=>{var r={};for(var o in e)et.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(e!=null&&C)for(var o of C(e))t.indexOf(o)<0&&rt.call(e,o)&&(r[o]=e[o]);return r};var m=(e,t)=>()=>(e&&(t=e(e=0)),t);var nt=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var E=(e,t,r)=>ot(e,typeof t!="symbol"?t+"":t,r),k=(e,t,r)=>t.has(e)||M("Cannot "+r);var n=(e,t,r)=>(k(e,t,"read from private field"),r?r.call(e):t.get(e)),u=(e,t,r)=>t.has(e)?M("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),_=(e,t,r,o)=>(k(e,t,"write to private field"),o?o.call(e,r):t.set(e,r),r);var h=(e,t,r)=>new Promise((o,a)=>{var i=d=>{try{l(r.next(d))}catch(I){a(I)}},R=d=>{try{l(r.throw(d))}catch(I){a(I)}},l=d=>d.done?o(d.value):Promise.resolve(d.value).then(i,R);l((r=r.apply(e,t)).next())});var at,pt,s,P=m(()=>{at="0.12.6",pt=`https://unpkg.com/@ffmpeg/core@${at}/dist/umd/ffmpeg-core.js`;(function(e){e.LOAD="LOAD",e.EXEC="EXEC",e.WRITE_FILE="WRITE_FILE",e.READ_FILE="READ_FILE",e.DELETE_FILE="DELETE_FILE",e.RENAME="RENAME",e.CREATE_DIR="CREATE_DIR",e.LIST_DIR="LIST_DIR",e.DELETE_DIR="DELETE_DIR",e.ERROR="ERROR",e.DOWNLOAD="DOWNLOAD",e.PROGRESS="PROGRESS",e.LOG="LOG",e.MOUNT="MOUNT",e.UNMOUNT="UNMOUNT"})(s||(s={}))});var v,j=m(()=>{v=(()=>{let e=0;return()=>e++})()});var ht,W,F,Lt,H=m(()=>{ht=new Error("unknown message type"),W=new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),F=new Error("called FFmpeg.terminate()"),Lt=new Error("failed to import ffmpeg-core.js")});var G,f,L,p,w,O,A,c,g,$=m(()=>{P();j();H();G={},g=class{constructor(){u(this,f,null);u(this,L,{});u(this,p,{});u(this,w,[]);u(this,O,[]);E(this,"loaded",!1);u(this,A,()=>{n(this,f)&&(n(this,f).onmessage=({data:{id:t,type:r,data:o}})=>{switch(r){case s.LOAD:this.loaded=!0,n(this,L)[t](o);break;case s.MOUNT:case s.UNMOUNT:case s.EXEC:case s.WRITE_FILE:case s.READ_FILE:case s.DELETE_FILE:case s.RENAME:case s.CREATE_DIR:case s.LIST_DIR:case s.DELETE_DIR:n(this,L)[t](o);break;case s.LOG:n(this,w).forEach(a=>a(o));break;case s.PROGRESS:n(this,O).forEach(a=>a(o));break;case s.ERROR:n(this,p)[t](o);break}delete n(this,L)[t],delete n(this,p)[t]})});u(this,c,({type:t,data:r},o=[],a)=>n(this,f)?new Promise((i,R)=>{let l=v();n(this,f)&&n(this,f).postMessage({id:l,type:t,data:r},o),n(this,L)[l]=i,n(this,p)[l]=R,a==null||a.addEventListener("abort",()=>{R(new DOMException(`Message # ${l} was aborted`,"AbortError"))},{once:!0})}):Promise.reject(W));E(this,"load",(a={},{signal:o}={})=>{var i=a,{classWorkerURL:t}=i,r=S(i,["classWorkerURL"]);return n(this,f)||(_(this,f,t?new Worker(new URL(t,G.url),{type:"module"}):new Worker(new URL("./worker.js",G.url),{type:"module"})),n(this,A).call(this)),n(this,c).call(this,{type:s.LOAD,data:r},void 0,o)});E(this,"exec",(t,r=-1,{signal:o}={})=>n(this,c).call(this,{type:s.EXEC,data:{args:t,timeout:r}},void 0,o));E(this,"terminate",()=>{let t=Object.keys(n(this,p));for(let r of t)n(this,p)[r](F),delete n(this,p)[r],delete n(this,L)[r];n(this,f)&&(n(this,f).terminate(),_(this,f,null),this.loaded=!1)});E(this,"writeFile",(t,r,{signal:o}={})=>{let a=[];return r instanceof Uint8Array&&a.push(r.buffer),n(this,c).call(this,{type:s.WRITE_FILE,data:{path:t,data:r}},a,o)});E(this,"mount",(t,r,o)=>{let a=[];return n(this,c).call(this,{type:s.MOUNT,data:{fsType:t,options:r,mountPoint:o}},a)});E(this,"unmount",t=>{let r=[];return n(this,c).call(this,{type:s.UNMOUNT,data:{mountPoint:t}},r)});E(this,"readFile",(t,r="binary",{signal:o}={})=>n(this,c).call(this,{type:s.READ_FILE,data:{path:t,encoding:r}},void 0,o));E(this,"deleteFile",(t,{signal:r}={})=>n(this,c).call(this,{type:s.DELETE_FILE,data:{path:t}},void 0,r));E(this,"rename",(t,r,{signal:o}={})=>n(this,c).call(this,{type:s.RENAME,data:{oldPath:t,newPath:r}},void 0,o));E(this,"createDir",(t,{signal:r}={})=>n(this,c).call(this,{type:s.CREATE_DIR,data:{path:t}},void 0,r));E(this,"listDir",(t,{signal:r}={})=>n(this,c).call(this,{type:s.LIST_DIR,data:{path:t}},void 0,r));E(this,"deleteDir",(t,{signal:r}={})=>n(this,c).call(this,{type:s.DELETE_DIR,data:{path:t}},void 0,r))}on(t,r){t==="log"?n(this,w).push(r):t==="progress"&&n(this,O).push(r)}off(t,r){t==="log"?_(this,w,n(this,w).filter(o=>o!==r)):t==="progress"&&_(this,O,n(this,O).filter(o=>o!==r))}};f=new WeakMap,L=new WeakMap,p=new WeakMap,w=new WeakMap,O=new WeakMap,A=new WeakMap,c=new WeakMap});var V=m(()=>{$()});var Y,X,z=m(()=>{Y=new Error("failed to get response body reader"),X=new Error("failed to complete download")});var J,K=m(()=>{J="Content-Length"});var st,Z,it,y,q=m(()=>{z();K();st=e=>new Promise((t,r)=>{let o=new FileReader;o.onload=()=>{let{result:a}=o;a instanceof ArrayBuffer?t(new Uint8Array(a)):t(new Uint8Array)},o.onerror=a=>{var i,R;r(Error(`File could not be read! Code=${((R=(i=a==null?void 0:a.target)==null?void 0:i.error)==null?void 0:R.code)||-1}`))},o.readAsArrayBuffer(e)}),Z=e=>h(void 0,null,function*(){let t;if(typeof e=="string")/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(e)?t=atob(e.split(",")[1]).split("").map(r=>r.charCodeAt(0)):t=yield(yield fetch(e)).arrayBuffer();else if(e instanceof URL)t=yield(yield fetch(e)).arrayBuffer();else if(e instanceof File||e instanceof Blob)t=yield st(e);else return new Uint8Array;return new Uint8Array(t)}),it=(e,t)=>h(void 0,null,function*(){var a;let r=yield fetch(e),o;try{let i=parseInt(r.headers.get(J)||"-1"),R=(a=r.body)==null?void 0:a.getReader();if(!R)throw Y;let l=[],d=0;for(;;){let{done:D,value:T}=yield R.read(),N=T?T.length:0;if(D){if(i!=-1&&i!==d)throw X;t&&t({url:e,total:i,received:d,delta:N,done:D});break}l.push(T),d+=N,t&&t({url:e,total:i,received:d,delta:N,done:D})}let I=new Uint8Array(d),B=0;for(let D of l)I.set(D,B),B+=D.length;o=I.buffer}catch(i){console.log("failed to send download progress event: ",i),o=yield r.arrayBuffer(),t&&t({url:e,total:o.byteLength,received:o.byteLength,delta:0,done:!0})}return o}),y=(e,t,r=!1,o)=>h(void 0,null,function*(){let a=r?yield it(e,o):yield(yield fetch(e)).arrayBuffer(),i=new Blob([a],{type:t});return URL.createObjectURL(i)})});var lt=nt(Q=>{V();q();var U=new g,b="https://unpkg.com/@ffmpeg/core-mt@0.12.6/dist/esm";function Et(){return h(this,null,function*(){let e={coreURL:yield y(`${b}/ffmpeg-core.js`,"text/javascript"),wasmURL:yield y(`${b}/ffmpeg-core.wasm`,"application/wasm"),workerURL:yield y(`${b}/ffmpeg-core.worker.js`,"text/javascript")};console.warn(e),yield U.load(e)})}Et().catch(console.error);var x=document.getElementById("fileInput"),ct=document.getElementById("trimButton"),dt=document.getElementById("videoOutput");ct.addEventListener("click",()=>h(Q,null,function*(){if(!x.files||x.files.length===0){alert("\u307E\u305A\u52D5\u753B\u30D5\u30A1\u30A4\u30EB\u3092\u9078\u629E\u3057\u3066\u304F\u3060\u3055\u3044\u3002");return}let e=document.getElementById("start").value,t=document.getElementById("end").value,r=yield ft(x.files[0],e,t);r&&(dt.src=r)}));function ft(e,t,r){return h(this,null,function*(){console.warn("ffmpeg loaded"),yield U.writeFile("input.mp4",yield Z(e));let o=(parseInt(r)-parseInt(t)).toString();yield U.exec(["-i","input.mp4","-ss",t,"-t",o,"output.mp4"]);let a=yield U.readFile("output.mp4"),i=new Blob([new Uint8Array(a)],{type:"video/mp4"});return URL.createObjectURL(i)})}});lt();})();
//# sourceMappingURL=main.js.map
