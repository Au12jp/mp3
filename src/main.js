"use strict";(()=>{var Q=Object.defineProperty;var B=Object.getOwnPropertySymbols;var tt=Object.prototype.hasOwnProperty,et=Object.prototype.propertyIsEnumerable;var C=e=>{throw TypeError(e)};var rt=(e,t,r)=>t in e?Q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var M=(e,t)=>{var r={};for(var o in e)tt.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(e!=null&&B)for(var o of B(e))t.indexOf(o)<0&&et.call(e,o)&&(r[o]=e[o]);return r};var m=(e,t)=>()=>(e&&(t=e(e=0)),t);var ot=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var c=(e,t,r)=>rt(e,typeof t!="symbol"?t+"":t,r),S=(e,t,r)=>t.has(e)||C("Cannot "+r);var n=(e,t,r)=>(S(e,t,"read from private field"),r?r.call(e):t.get(e)),u=(e,t,r)=>t.has(e)?C("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),_=(e,t,r,o)=>(S(e,t,"write to private field"),o?o.call(e,r):t.set(e,r),r);var h=(e,t,r)=>new Promise((o,a)=>{var i=d=>{try{f(r.next(d))}catch(I){a(I)}},R=d=>{try{f(r.throw(d))}catch(I){a(I)}},f=d=>d.done?o(d.value):Promise.resolve(d.value).then(i,R);f((r=r.apply(e,t)).next())});var nt,Rt,s,k=m(()=>{nt="0.12.6",Rt=`https://unpkg.com/@ffmpeg/core@${nt}/dist/umd/ffmpeg-core.js`;(function(e){e.LOAD="LOAD",e.EXEC="EXEC",e.WRITE_FILE="WRITE_FILE",e.READ_FILE="READ_FILE",e.DELETE_FILE="DELETE_FILE",e.RENAME="RENAME",e.CREATE_DIR="CREATE_DIR",e.LIST_DIR="LIST_DIR",e.DELETE_DIR="DELETE_DIR",e.ERROR="ERROR",e.DOWNLOAD="DOWNLOAD",e.PROGRESS="PROGRESS",e.LOG="LOG",e.MOUNT="MOUNT",e.UNMOUNT="UNMOUNT"})(s||(s={}))});var v,P=m(()=>{v=(()=>{let e=0;return()=>e++})()});var ut,j,W,ht,F=m(()=>{ut=new Error("unknown message type"),j=new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),W=new Error("called FFmpeg.terminate()"),ht=new Error("failed to import ffmpeg-core.js")});var H,l,L,p,w,O,y,E,A,G=m(()=>{k();P();F();H={},A=class{constructor(){u(this,l,null);u(this,L,{});u(this,p,{});u(this,w,[]);u(this,O,[]);c(this,"loaded",!1);u(this,y,()=>{n(this,l)&&(n(this,l).onmessage=({data:{id:t,type:r,data:o}})=>{switch(r){case s.LOAD:this.loaded=!0,n(this,L)[t](o);break;case s.MOUNT:case s.UNMOUNT:case s.EXEC:case s.WRITE_FILE:case s.READ_FILE:case s.DELETE_FILE:case s.RENAME:case s.CREATE_DIR:case s.LIST_DIR:case s.DELETE_DIR:n(this,L)[t](o);break;case s.LOG:n(this,w).forEach(a=>a(o));break;case s.PROGRESS:n(this,O).forEach(a=>a(o));break;case s.ERROR:n(this,p)[t](o);break}delete n(this,L)[t],delete n(this,p)[t]})});u(this,E,({type:t,data:r},o=[],a)=>n(this,l)?new Promise((i,R)=>{let f=v();n(this,l)&&n(this,l).postMessage({id:f,type:t,data:r},o),n(this,L)[f]=i,n(this,p)[f]=R,a==null||a.addEventListener("abort",()=>{R(new DOMException(`Message # ${f} was aborted`,"AbortError"))},{once:!0})}):Promise.reject(j));c(this,"load",(a={},{signal:o}={})=>{var i=a,{classWorkerURL:t}=i,r=M(i,["classWorkerURL"]);return n(this,l)||(_(this,l,t?new Worker(new URL(t,H.url),{type:"module"}):new Worker(new URL("./worker.js",H.url),{type:"module"})),n(this,y).call(this)),n(this,E).call(this,{type:s.LOAD,data:r},void 0,o)});c(this,"exec",(t,r=-1,{signal:o}={})=>n(this,E).call(this,{type:s.EXEC,data:{args:t,timeout:r}},void 0,o));c(this,"terminate",()=>{let t=Object.keys(n(this,p));for(let r of t)n(this,p)[r](W),delete n(this,p)[r],delete n(this,L)[r];n(this,l)&&(n(this,l).terminate(),_(this,l,null),this.loaded=!1)});c(this,"writeFile",(t,r,{signal:o}={})=>{let a=[];return r instanceof Uint8Array&&a.push(r.buffer),n(this,E).call(this,{type:s.WRITE_FILE,data:{path:t,data:r}},a,o)});c(this,"mount",(t,r,o)=>{let a=[];return n(this,E).call(this,{type:s.MOUNT,data:{fsType:t,options:r,mountPoint:o}},a)});c(this,"unmount",t=>{let r=[];return n(this,E).call(this,{type:s.UNMOUNT,data:{mountPoint:t}},r)});c(this,"readFile",(t,r="binary",{signal:o}={})=>n(this,E).call(this,{type:s.READ_FILE,data:{path:t,encoding:r}},void 0,o));c(this,"deleteFile",(t,{signal:r}={})=>n(this,E).call(this,{type:s.DELETE_FILE,data:{path:t}},void 0,r));c(this,"rename",(t,r,{signal:o}={})=>n(this,E).call(this,{type:s.RENAME,data:{oldPath:t,newPath:r}},void 0,o));c(this,"createDir",(t,{signal:r}={})=>n(this,E).call(this,{type:s.CREATE_DIR,data:{path:t}},void 0,r));c(this,"listDir",(t,{signal:r}={})=>n(this,E).call(this,{type:s.LIST_DIR,data:{path:t}},void 0,r));c(this,"deleteDir",(t,{signal:r}={})=>n(this,E).call(this,{type:s.DELETE_DIR,data:{path:t}},void 0,r))}on(t,r){t==="log"?n(this,w).push(r):t==="progress"&&n(this,O).push(r)}off(t,r){t==="log"?_(this,w,n(this,w).filter(o=>o!==r)):t==="progress"&&_(this,O,n(this,O).filter(o=>o!==r))}};l=new WeakMap,L=new WeakMap,p=new WeakMap,w=new WeakMap,O=new WeakMap,y=new WeakMap,E=new WeakMap});var V=m(()=>{G()});var Y,X,$=m(()=>{Y=new Error("failed to get response body reader"),X=new Error("failed to complete download")});var z,J=m(()=>{z="Content-Length"});var at,K,st,g,Z=m(()=>{$();J();at=e=>new Promise((t,r)=>{let o=new FileReader;o.onload=()=>{let{result:a}=o;a instanceof ArrayBuffer?t(new Uint8Array(a)):t(new Uint8Array)},o.onerror=a=>{var i,R;r(Error(`File could not be read! Code=${((R=(i=a==null?void 0:a.target)==null?void 0:i.error)==null?void 0:R.code)||-1}`))},o.readAsArrayBuffer(e)}),K=e=>h(void 0,null,function*(){let t;if(typeof e=="string")/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(e)?t=atob(e.split(",")[1]).split("").map(r=>r.charCodeAt(0)):t=yield(yield fetch(e)).arrayBuffer();else if(e instanceof URL)t=yield(yield fetch(e)).arrayBuffer();else if(e instanceof File||e instanceof Blob)t=yield at(e);else return new Uint8Array;return new Uint8Array(t)}),st=(e,t)=>h(void 0,null,function*(){var a;let r=yield fetch(e),o;try{let i=parseInt(r.headers.get(z)||"-1"),R=(a=r.body)==null?void 0:a.getReader();if(!R)throw Y;let f=[],d=0;for(;;){let{done:D,value:T}=yield R.read(),N=T?T.length:0;if(D){if(i!=-1&&i!==d)throw X;t&&t({url:e,total:i,received:d,delta:N,done:D});break}f.push(T),d+=N,t&&t({url:e,total:i,received:d,delta:N,done:D})}let I=new Uint8Array(d),x=0;for(let D of f)I.set(D,x),x+=D.length;o=I.buffer}catch(i){console.log("failed to send download progress event: ",i),o=yield r.arrayBuffer(),t&&t({url:e,total:o.byteLength,received:o.byteLength,delta:0,done:!0})}return o}),g=(e,t,r=!1,o)=>h(void 0,null,function*(){let a=r?yield st(e,o):yield(yield fetch(e)).arrayBuffer(),i=new Blob([a],{type:t});return URL.createObjectURL(i)})});var lt=ot(q=>{V();Z();var U=new A;function it(){return h(this,null,function*(){let e={classWorkerURL:yield g("./core-mt/worker.js","text/javascript"),coreURL:yield g("./core-mt/ffmpeg-core.js","text/javascript"),wasmURL:yield g("./core-mt/ffmpeg-core.wasm","application/wasm"),workerURL:yield g("./core-mt/ffmpeg-core.worker.js","text/javascript")};console.warn(e),yield U.load(e)})}it().catch(console.error);var b=document.getElementById("fileInput"),ct=document.getElementById("trimButton"),Et=document.getElementById("videoOutput");ct.addEventListener("click",()=>h(q,null,function*(){if(!b.files||b.files.length===0){alert("\u307E\u305A\u52D5\u753B\u30D5\u30A1\u30A4\u30EB\u3092\u9078\u629E\u3057\u3066\u304F\u3060\u3055\u3044\u3002");return}let e=document.getElementById("start").value,t=document.getElementById("end").value,r=yield dt(b.files[0],e,t);r&&(Et.src=r)}));function dt(e,t,r){return h(this,null,function*(){console.warn("ffmpeg loaded"),yield U.writeFile("input.mp4",yield K(e));let o=(parseInt(r)-parseInt(t)).toString();yield U.exec(["-i","input.mp4","-ss",t,"-t",o,"output.mp4"]);let a=yield U.readFile("output.mp4"),i=new Blob([new Uint8Array(a)],{type:"video/mp4"});return URL.createObjectURL(i)})}});lt();})();
//# sourceMappingURL=main.js.map
