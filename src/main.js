"use strict";(()=>{var F=Object.defineProperty;var N=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var b=e=>{throw TypeError(e)};var X=(e,t,r)=>t in e?F(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var x=(e,t)=>{var r={};for(var o in e)$.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(e!=null&&N)for(var o of N(e))t.indexOf(o)<0&&Y.call(e,o)&&(r[o]=e[o]);return r};var l=(e,t,r)=>X(e,typeof t!="symbol"?t+"":t,r),S=(e,t,r)=>t.has(e)||b("Cannot "+r);var n=(e,t,r)=>(S(e,t,"read from private field"),r?r.call(e):t.get(e)),R=(e,t,r)=>t.has(e)?b("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),I=(e,t,r,o)=>(S(e,t,"write to private field"),o?o.call(e,r):t.set(e,r),r);var h=(e,t,r)=>new Promise((o,s)=>{var i=c=>{try{d(r.next(c))}catch(O){s(O)}},E=c=>{try{d(r.throw(c))}catch(O){s(O)}},d=c=>c.done?o(c.value):Promise.resolve(c.value).then(i,E);d((r=r.apply(e,t)).next())});var z="0.12.6",et=`https://unpkg.com/@ffmpeg/core@${z}/dist/umd/ffmpeg-core.js`,a;(function(e){e.LOAD="LOAD",e.EXEC="EXEC",e.WRITE_FILE="WRITE_FILE",e.READ_FILE="READ_FILE",e.DELETE_FILE="DELETE_FILE",e.RENAME="RENAME",e.CREATE_DIR="CREATE_DIR",e.LIST_DIR="LIST_DIR",e.DELETE_DIR="DELETE_DIR",e.ERROR="ERROR",e.DOWNLOAD="DOWNLOAD",e.PROGRESS="PROGRESS",e.LOG="LOG",e.MOUNT="MOUNT",e.UNMOUNT="UNMOUNT"})(a||(a={}));var B=(()=>{let e=0;return()=>e++})();var nt=new Error("unknown message type"),M=new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),C=new Error("called FFmpeg.terminate()"),st=new Error("failed to import ffmpeg-core.js");var k={};var m,u,p,L,w,g,f,_=class{constructor(){R(this,m,null);R(this,u,{});R(this,p,{});R(this,L,[]);R(this,w,[]);l(this,"loaded",!1);R(this,g,()=>{n(this,m)&&(n(this,m).onmessage=({data:{id:t,type:r,data:o}})=>{switch(r){case a.LOAD:this.loaded=!0,n(this,u)[t](o);break;case a.MOUNT:case a.UNMOUNT:case a.EXEC:case a.WRITE_FILE:case a.READ_FILE:case a.DELETE_FILE:case a.RENAME:case a.CREATE_DIR:case a.LIST_DIR:case a.DELETE_DIR:n(this,u)[t](o);break;case a.LOG:n(this,L).forEach(s=>s(o));break;case a.PROGRESS:n(this,w).forEach(s=>s(o));break;case a.ERROR:n(this,p)[t](o);break}delete n(this,u)[t],delete n(this,p)[t]})});R(this,f,({type:t,data:r},o=[],s)=>n(this,m)?new Promise((i,E)=>{let d=B();n(this,m)&&n(this,m).postMessage({id:d,type:t,data:r},o),n(this,u)[d]=i,n(this,p)[d]=E,s==null||s.addEventListener("abort",()=>{E(new DOMException(`Message # ${d} was aborted`,"AbortError"))},{once:!0})}):Promise.reject(M));l(this,"load",(s={},{signal:o}={})=>{var i=s,{classWorkerURL:t}=i,r=x(i,["classWorkerURL"]);return n(this,m)||(I(this,m,t?new Worker(new URL(t,k.url),{type:"module"}):new Worker(new URL("./worker.js",k.url),{type:"module"})),n(this,g).call(this)),n(this,f).call(this,{type:a.LOAD,data:r},void 0,o)});l(this,"exec",(t,r=-1,{signal:o}={})=>n(this,f).call(this,{type:a.EXEC,data:{args:t,timeout:r}},void 0,o));l(this,"terminate",()=>{let t=Object.keys(n(this,p));for(let r of t)n(this,p)[r](C),delete n(this,p)[r],delete n(this,u)[r];n(this,m)&&(n(this,m).terminate(),I(this,m,null),this.loaded=!1)});l(this,"writeFile",(t,r,{signal:o}={})=>{let s=[];return r instanceof Uint8Array&&s.push(r.buffer),n(this,f).call(this,{type:a.WRITE_FILE,data:{path:t,data:r}},s,o)});l(this,"mount",(t,r,o)=>{let s=[];return n(this,f).call(this,{type:a.MOUNT,data:{fsType:t,options:r,mountPoint:o}},s)});l(this,"unmount",t=>{let r=[];return n(this,f).call(this,{type:a.UNMOUNT,data:{mountPoint:t}},r)});l(this,"readFile",(t,r="binary",{signal:o}={})=>n(this,f).call(this,{type:a.READ_FILE,data:{path:t,encoding:r}},void 0,o));l(this,"deleteFile",(t,{signal:r}={})=>n(this,f).call(this,{type:a.DELETE_FILE,data:{path:t}},void 0,r));l(this,"rename",(t,r,{signal:o}={})=>n(this,f).call(this,{type:a.RENAME,data:{oldPath:t,newPath:r}},void 0,o));l(this,"createDir",(t,{signal:r}={})=>n(this,f).call(this,{type:a.CREATE_DIR,data:{path:t}},void 0,r));l(this,"listDir",(t,{signal:r}={})=>n(this,f).call(this,{type:a.LIST_DIR,data:{path:t}},void 0,r));l(this,"deleteDir",(t,{signal:r}={})=>n(this,f).call(this,{type:a.DELETE_DIR,data:{path:t}},void 0,r))}on(t,r){t==="log"?n(this,L).push(r):t==="progress"&&n(this,w).push(r)}off(t,r){t==="log"?I(this,L,n(this,L).filter(o=>o!==r)):t==="progress"&&I(this,w,n(this,w).filter(o=>o!==r))}};m=new WeakMap,u=new WeakMap,p=new WeakMap,L=new WeakMap,w=new WeakMap,g=new WeakMap,f=new WeakMap;var v=new Error("failed to get response body reader"),P=new Error("failed to complete download");var j="Content-Length";var J=e=>new Promise((t,r)=>{let o=new FileReader;o.onload=()=>{let{result:s}=o;s instanceof ArrayBuffer?t(new Uint8Array(s)):t(new Uint8Array)},o.onerror=s=>{var i,E;r(Error(`File could not be read! Code=${((E=(i=s==null?void 0:s.target)==null?void 0:i.error)==null?void 0:E.code)||-1}`))},o.readAsArrayBuffer(e)}),W=e=>h(void 0,null,function*(){let t;if(typeof e=="string")/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(e)?t=atob(e.split(",")[1]).split("").map(r=>r.charCodeAt(0)):t=yield(yield fetch(e)).arrayBuffer();else if(e instanceof URL)t=yield(yield fetch(e)).arrayBuffer();else if(e instanceof File||e instanceof Blob)t=yield J(e);else return new Uint8Array;return new Uint8Array(t)});var K=(e,t)=>h(void 0,null,function*(){var s;let r=yield fetch(e),o;try{let i=parseInt(r.headers.get(j)||"-1"),E=(s=r.body)==null?void 0:s.getReader();if(!E)throw v;let d=[],c=0;for(;;){let{done:D,value:y}=yield E.read(),T=y?y.length:0;if(D){if(i!=-1&&i!==c)throw P;t&&t({url:e,total:i,received:c,delta:T,done:D});break}d.push(y),c+=T,t&&t({url:e,total:i,received:c,delta:T,done:D})}let O=new Uint8Array(c),U=0;for(let D of d)O.set(D,U),U+=D.length;o=O.buffer}catch(i){console.log("failed to send download progress event: ",i),o=yield r.arrayBuffer(),t&&t({url:e,total:o.byteLength,received:o.byteLength,delta:0,done:!0})}return o}),A=(e,t,r=!1,o)=>h(void 0,null,function*(){let s=r?yield K(e,o):yield(yield fetch(e)).arrayBuffer(),i=new Blob([s],{type:t});return URL.createObjectURL(i)});var V;(V=document.getElementById("trimButton"))==null||V.addEventListener("click",Z);function H(e){let t=Math.floor(e/3600),r=Math.floor(e%3600/60),o=e%60;return(t<10?"0"+t:t)+":"+(r<10?"0"+r:r)+":"+(o<10?"0"+o:o)}function Z(){return h(this,null,function*(){var s,i;let e=document.getElementById("fileInput");if(!e||!e.files){alert("\u30D5\u30A1\u30A4\u30EB\u304C\u9078\u629E\u3055\u308C\u3066\u3044\u307E\u305B\u3093\u3002");return}let t=(s=document.getElementById("startTime"))==null?void 0:s.value,r=(i=document.getElementById("endTime"))==null?void 0:i.value;if(!t||!r){alert("\u958B\u59CB\u6642\u9593\u3068\u7D42\u4E86\u6642\u9593\u3092\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044\u3002");return}let o=e.files[0];if(!o){alert("\u52D5\u753B\u30D5\u30A1\u30A4\u30EB\u3092\u9078\u629E\u3057\u3066\u304F\u3060\u3055\u3044\u3002");return}try{let E=yield q(o,H(Number(t)),H(Number(r))),d=document.getElementById("preview");d.src=E;let c=document.createElement("a");c.download="trimmed_video.mp4",c.href=E,c.click()}catch(E){console.error("\u30A8\u30E9\u30FC\u304C\u767A\u751F\u3057\u307E\u3057\u305F: ",E)}})}function q(e,t,r){return h(this,null,function*(){let o=new _,s="https://unpkg.com/@ffmpeg/core-mt@0.12.6/dist/esm";yield o.load({coreURL:yield A(`${s}/ffmpeg-core.js`,"text/javascript"),wasmURL:yield A(`${s}/ffmpeg-core.wasm`,"application/wasm"),workerURL:yield A(`${s}/ffmpeg-core.worker.js`,"text/javascript")}),console.log("FFmpeg\u30ED\u30FC\u30C9\u5B8C\u4E86"),yield o.writeFile("input.mp4",yield W(e)),console.log("input.mp4\u66F8\u304D\u8FBC\u307F\u5B8C\u4E86");let i=Q(t,r);yield o.exec(["-i","input.mp4","-ss",t,"-t",i,"output.mp4"]),console.log("output.mp4\u66F8\u304D\u8FBC\u307F\u5B8C\u4E86");let E=yield o.readFile("output.mp4");console.log("output.mp4\u8AAD\u307F\u8FBC\u307F\u5B8C\u4E86");let d=new Blob([new Uint8Array(E)],{type:"video/mp4"}),c=URL.createObjectURL(d);return console.log("URL\u4F5C\u6210\u5B8C\u4E86"),c})}function Q(e,t){let r=G(e);return(G(t)-r).toString()}function G(e){let t=e.split(":").map(Number);return t[0]*3600+t[1]*60+t[2]}})();
//# sourceMappingURL=main.js.map
