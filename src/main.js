"use strict";(()=>{var Ve=Object.create;var ee=Object.defineProperty;var Je=Object.getOwnPropertyDescriptor;var Ze=Object.getOwnPropertyNames,D=Object.getOwnPropertySymbols,Ke=Object.getPrototypeOf,te=Object.prototype.hasOwnProperty,ge=Object.prototype.propertyIsEnumerable;var de=(t,i,o)=>i in t?ee(t,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[i]=o,Y=(t,i)=>{for(var o in i||(i={}))te.call(i,o)&&de(t,o,i[o]);if(D)for(var o of D(i))ge.call(i,o)&&de(t,o,i[o]);return t};var ve=(t,i)=>{var o={};for(var a in t)te.call(t,a)&&i.indexOf(a)<0&&(o[a]=t[a]);if(t!=null&&D)for(var a of D(t))i.indexOf(a)<0&&ge.call(t,a)&&(o[a]=t[a]);return o};var L=(t,i)=>()=>(i||t((i={exports:{}}).exports,i),i.exports);var Qe=(t,i,o,a)=>{if(i&&typeof i=="object"||typeof i=="function")for(let f of Ze(i))!te.call(t,f)&&f!==o&&ee(t,f,{get:()=>i[f],enumerable:!(a=Je(i,f))||a.enumerable});return t};var Xe=(t,i,o)=>(o=t!=null?Ve(Ke(t)):{},Qe(i||!t||!t.__esModule?ee(o,"default",{value:t,enumerable:!0}):o,t));var P=(t,i,o)=>new Promise((a,f)=>{var c=h=>{try{m(o.next(h))}catch(d){f(d)}},g=h=>{try{m(o.throw(h))}catch(d){f(d)}},m=h=>h.done?a(h.value):Promise.resolve(h.value).then(c,g);m((o=o.apply(t,i)).next())});var we=L((Lt,ne)=>{var re=function(t){"use strict";var i=Object.prototype,o=i.hasOwnProperty,a=Object.defineProperty||function(r,e,n){r[e]=n.value},f,c=typeof Symbol=="function"?Symbol:{},g=c.iterator||"@@iterator",m=c.asyncIterator||"@@asyncIterator",h=c.toStringTag||"@@toStringTag";function d(r,e,n){return Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),r[e]}try{d({},"")}catch(r){d=function(e,n,l){return e[n]=l}}function x(r,e,n,l){var s=e&&e.prototype instanceof B?e:B,u=Object.create(s.prototype),y=new K(l||[]);return a(u,"_invoke",{value:He(r,n,y)}),u}t.wrap=x;function q(r,e,n){try{return{type:"normal",arg:r.call(e,n)}}catch(l){return{type:"throw",arg:l}}}var I="suspendedStart",J="suspendedYield",W="executing",R="completed",F={};function B(){}function U(){}function k(){}var p={};d(p,g,function(){return this});var v=Object.getPrototypeOf,w=v&&v(v(Q([])));w&&w!==i&&o.call(w,g)&&(p=w);var j=k.prototype=B.prototype=Object.create(p);U.prototype=k,a(j,"constructor",{value:k,configurable:!0}),a(k,"constructor",{value:U,configurable:!0}),U.displayName=d(k,h,"GeneratorFunction");function O(r){["next","throw","return"].forEach(function(e){d(r,e,function(n){return this._invoke(e,n)})})}t.isGeneratorFunction=function(r){var e=typeof r=="function"&&r.constructor;return e?e===U||(e.displayName||e.name)==="GeneratorFunction":!1},t.mark=function(r){return Object.setPrototypeOf?Object.setPrototypeOf(r,k):(r.__proto__=k,d(r,h,"GeneratorFunction")),r.prototype=Object.create(j),r},t.awrap=function(r){return{__await:r}};function _(r,e){function n(u,y,b,S){var E=q(r[u],r,y);if(E.type==="throw")S(E.arg);else{var X=E.arg,G=X.value;return G&&typeof G=="object"&&o.call(G,"__await")?e.resolve(G.__await).then(function(C){n("next",C,b,S)},function(C){n("throw",C,b,S)}):e.resolve(G).then(function(C){X.value=C,b(X)},function(C){return n("throw",C,b,S)})}}var l;function s(u,y){function b(){return new e(function(S,E){n(u,y,S,E)})}return l=l?l.then(b,b):b()}a(this,"_invoke",{value:s})}O(_.prototype),d(_.prototype,m,function(){return this}),t.AsyncIterator=_,t.async=function(r,e,n,l,s){s===void 0&&(s=Promise);var u=new _(x(r,e,n,l),s);return t.isGeneratorFunction(e)?u:u.next().then(function(y){return y.done?y.value:u.next()})};function He(r,e,n){var l=I;return function(u,y){if(l===W)throw new Error("Generator is already running");if(l===R){if(u==="throw")throw y;return me()}for(n.method=u,n.arg=y;;){var b=n.delegate;if(b){var S=he(b,n);if(S){if(S===F)continue;return S}}if(n.method==="next")n.sent=n._sent=n.arg;else if(n.method==="throw"){if(l===I)throw l=R,n.arg;n.dispatchException(n.arg)}else n.method==="return"&&n.abrupt("return",n.arg);l=W;var E=q(r,e,n);if(E.type==="normal"){if(l=n.done?R:J,E.arg===F)continue;return{value:E.arg,done:n.done}}else E.type==="throw"&&(l=R,n.method="throw",n.arg=E.arg)}}}function he(r,e){var n=e.method,l=r.iterator[n];if(l===f)return e.delegate=null,n==="throw"&&r.iterator.return&&(e.method="return",e.arg=f,he(r,e),e.method==="throw")||n!=="return"&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),F;var s=q(l,r.iterator,e.arg);if(s.type==="throw")return e.method="throw",e.arg=s.arg,e.delegate=null,F;var u=s.arg;if(!u)return e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,F;if(u.done)e[r.resultName]=u.value,e.next=r.nextLoc,e.method!=="return"&&(e.method="next",e.arg=f);else return u;return e.delegate=null,F}O(j),d(j,h,"Generator"),d(j,g,function(){return this}),d(j,"toString",function(){return"[object Generator]"});function ze(r){var e={tryLoc:r[0]};1 in r&&(e.catchLoc=r[1]),2 in r&&(e.finallyLoc=r[2],e.afterLoc=r[3]),this.tryEntries.push(e)}function Z(r){var e=r.completion||{};e.type="normal",delete e.arg,r.completion=e}function K(r){this.tryEntries=[{tryLoc:"root"}],r.forEach(ze,this),this.reset(!0)}t.keys=function(r){var e=Object(r),n=[];for(var l in e)n.push(l);return n.reverse(),function s(){for(;n.length;){var u=n.pop();if(u in e)return s.value=u,s.done=!1,s}return s.done=!0,s}};function Q(r){if(r){var e=r[g];if(e)return e.call(r);if(typeof r.next=="function")return r;if(!isNaN(r.length)){var n=-1,l=function s(){for(;++n<r.length;)if(o.call(r,n))return s.value=r[n],s.done=!1,s;return s.value=f,s.done=!0,s};return l.next=l}}return{next:me}}t.values=Q;function me(){return{value:f,done:!0}}return K.prototype={constructor:K,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=f,this.done=!1,this.delegate=null,this.method="next",this.arg=f,this.tryEntries.forEach(Z),!r)for(var e in this)e.charAt(0)==="t"&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=f)},stop:function(){this.done=!0;var r=this.tryEntries[0],e=r.completion;if(e.type==="throw")throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(S,E){return u.type="throw",u.arg=r,e.next=S,E&&(e.method="next",e.arg=f),!!E}for(var l=this.tryEntries.length-1;l>=0;--l){var s=this.tryEntries[l],u=s.completion;if(s.tryLoc==="root")return n("end");if(s.tryLoc<=this.prev){var y=o.call(s,"catchLoc"),b=o.call(s,"finallyLoc");if(y&&b){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(y){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else if(b){if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(r,e){for(var n=this.tryEntries.length-1;n>=0;--n){var l=this.tryEntries[n];if(l.tryLoc<=this.prev&&o.call(l,"finallyLoc")&&this.prev<l.finallyLoc){var s=l;break}}s&&(r==="break"||r==="continue")&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var u=s?s.completion:{};return u.type=r,u.arg=e,s?(this.method="next",this.next=s.finallyLoc,F):this.complete(u)},complete:function(r,e){if(r.type==="throw")throw r.arg;return r.type==="break"||r.type==="continue"?this.next=r.arg:r.type==="return"?(this.rval=this.arg=r.arg,this.method="return",this.next="end"):r.type==="normal"&&e&&(this.next=e),F},finish:function(r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===r)return this.complete(n.completion,n.afterLoc),Z(n),F}},catch:function(r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===r){var l=n.completion;if(l.type==="throw"){var s=l.arg;Z(n)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:Q(r),resultName:e,nextLoc:n},this.method==="next"&&(this.arg=f),F}},t}(typeof ne=="object"?ne.exports:{});try{regeneratorRuntime=re}catch(t){typeof globalThis=="object"?globalThis.regeneratorRuntime=re:Function("r","regeneratorRuntime = r")(re)}});var be=L((Ft,ye)=>{ye.exports={defaultArgs:["./ffmpeg","-nostdin","-y"],baseOptions:{log:!1,logger:()=>{},progress:()=>{},corePath:""}}});var ie=L((jt,Le)=>{var oe=!1,Ee=()=>{},et=t=>{oe=t},tt=t=>{Ee=t},rt=(t,i)=>{Ee({type:t,message:i}),oe&&console.log(`[${t}] ${i}`)};Le.exports={logging:oe,setLogging:et,setCustomLogger:tt,log:rt}});var Se=L((St,je)=>{var N=0,ae=0,Fe=t=>{let[i,o,a]=t.split(":");return parseFloat(i)*60*60+parseFloat(o)*60+parseFloat(a)};je.exports=(t,i)=>{if(typeof t=="string")if(t.startsWith("  Duration")){let o=t.split(", ")[0].split(": ")[1],a=Fe(o);i({duration:a,ratio:ae}),(N===0||N>a)&&(N=a)}else if(t.startsWith("frame")||t.startsWith("size")){let o=t.split("time=")[1].split(" ")[0],a=Fe(o);ae=a/N,i({ratio:ae,time:a})}else t.startsWith("video:")&&(i({ratio:1}),N=0)}});var Oe=L((kt,ke)=>{ke.exports=(t,i)=>{let o=t._malloc(i.length*Uint32Array.BYTES_PER_ELEMENT);return i.forEach((a,f)=>{let c=t._malloc(a.length+1);t.writeAsciiToMemory(a,c),t.setValue(o+Uint32Array.BYTES_PER_ELEMENT*f,c,"i32")}),[i.length,o]}});var H=L((se,Pe)=>{(function(t,i){typeof define=="function"&&define.amd?define(i):typeof se=="object"?Pe.exports=i():t.resolveUrl=i()})(se,function(){function t(){var i=arguments.length;if(i===0)throw new Error("resolveUrl requires at least one argument; got none.");var o=document.createElement("base");if(o.href=arguments[0],i===1)return o.href;var a=document.getElementsByTagName("head")[0];a.insertBefore(o,a.firstChild);for(var f=document.createElement("a"),c,g=1;g<i;g++)f.href=arguments[g],c=f.href,o.href=c;return a.removeChild(o),c}return t})});var le=L((Ot,nt)=>{nt.exports={name:"@ffmpeg/ffmpeg",version:"0.10.1",description:"FFmpeg WebAssembly version",main:"src/index.js",types:"src/index.d.ts",directories:{example:"examples"},scripts:{start:"node scripts/server.js",build:"rimraf dist && webpack --config scripts/webpack.config.prod.js",prepublishOnly:"npm run build",lint:"eslint src",wait:"rimraf dist && wait-on http://localhost:3000/dist/ffmpeg.dev.js",test:"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser:ffmpeg test:node:all","test:node":"node --experimental-wasm-threads --experimental-wasm-bulk-memory node_modules/.bin/_mocha --exit --bail --require ./scripts/test-helper.js","test:node:all":"npm run test:node -- ./tests/*.test.js","test:browser":"mocha-headless-chrome -a allow-file-access-from-files -a incognito -a no-sandbox -a disable-setuid-sandbox -a disable-logging -t 300000","test:browser:ffmpeg":"npm run test:browser -- -f ./tests/ffmpeg.test.html"},browser:{"./src/node/index.js":"./src/browser/index.js"},repository:{type:"git",url:"git+https://github.com/ffmpegwasm/ffmpeg.wasm.git"},keywords:["ffmpeg","WebAssembly","video"],author:"Jerome Wu <jeromewus@gmail.com>",license:"MIT",bugs:{url:"https://github.com/ffmpegwasm/ffmpeg.wasm/issues"},engines:{node:">=12.16.1"},homepage:"https://github.com/ffmpegwasm/ffmpeg.wasm#readme",dependencies:{"is-url":"^1.2.4","node-fetch":"^2.6.1","regenerator-runtime":"^0.13.7","resolve-url":"^0.2.1"},devDependencies:{"@babel/core":"^7.12.3","@babel/preset-env":"^7.12.1","@ffmpeg/core":"^0.10.0","@types/emscripten":"^1.39.4","babel-loader":"^8.1.0",chai:"^4.2.0",cors:"^2.8.5",eslint:"^7.12.1","eslint-config-airbnb-base":"^14.1.0","eslint-plugin-import":"^2.22.1",express:"^4.17.1",mocha:"^8.2.1","mocha-headless-chrome":"^2.0.3","npm-run-all":"^4.1.5","wait-on":"^5.3.0",webpack:"^5.3.2","webpack-cli":"^4.1.0","webpack-dev-middleware":"^4.0.0"}}});var Te=L((Ct,Ce)=>{var Pt=H(),{devDependencies:ot}=le();Ce.exports={corePath:`https://unpkg.com/@ffmpeg/core@${ot["@ffmpeg/core"].substring(1)}/dist/ffmpeg-core.js`}});var Re=L((ce,qe)=>{var it=H(),{log:$}=ie(),fe=(t,i)=>P(ce,null,function*(){$("info",`fetch ${t}`);let o=yield(yield fetch(t)).arrayBuffer();$("info",`${t} file size = ${o.byteLength} bytes`);let a=new Blob([o],{type:i}),f=URL.createObjectURL(a);return $("info",`${t} blob URL = ${f}`),f});qe.exports=i=>P(ce,[i],function*({corePath:t}){if(typeof t!="string")throw Error("corePath should be a string!");let o=it(t),a=yield fe(o,"application/javascript"),f=yield fe(o.replace("ffmpeg-core.js","ffmpeg-core.wasm"),"application/wasm"),c=yield fe(o.replace("ffmpeg-core.js","ffmpeg-core.worker.js"),"application/javascript");return typeof createFFmpegCore=="undefined"?new Promise(g=>{let m=document.createElement("script"),h=()=>{m.removeEventListener("load",h),$("info","ffmpeg-core.js script loaded"),g({createFFmpegCore,corePath:a,wasmPath:f,workerPath:c})};m.src=a,m.type="text/javascript",m.addEventListener("load",h),document.getElementsByTagName("head")[0].appendChild(m)}):($("info","ffmpeg-core.js script is loaded already"),Promise.resolve({createFFmpegCore,corePath:a,wasmPath:f,workerPath:c}))})});var Ae=L((Ue,_e)=>{var at=H(),st=t=>new Promise((i,o)=>{let a=new FileReader;a.onload=()=>{i(a.result)},a.onerror=({target:{error:{code:f}}})=>{o(Error(`File could not be read! Code=${f}`))},a.readAsArrayBuffer(t)});_e.exports=t=>P(Ue,null,function*(){let i=t;return typeof t=="undefined"?new Uint8Array:(typeof t=="string"?/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(t)?i=atob(t.split(",")[1]).split("").map(o=>o.charCodeAt(0)):i=yield(yield fetch(at(t))).arrayBuffer():(t instanceof File||t instanceof Blob)&&(i=yield st(t)),new Uint8Array(i))})});var ue=L((Rt,Be)=>{var lt=Te(),ft=Re(),ct=Ae();Be.exports={defaultOptions:lt,getCreateFFmpegCore:ft,fetchFile:ct}});var xe=L(($e,Me)=>{var{defaultArgs:ut,baseOptions:pt}=be(),{setLogging:Ge,setCustomLogger:Ne,log:T}=ie(),ht=Se(),mt=Oe(),{defaultOptions:dt,getCreateFFmpegCore:gt}=ue(),{version:vt}=le(),pe=Error("ffmpeg.wasm is not ready, make sure you have completed load().");Me.exports=(t={})=>{let k=Y(Y(Y({},pt),dt),t),{log:i,logger:o,progress:a}=k,f=ve(k,["log","logger","progress"]),c=null,g=null,m=null,h=!1,d=a,x=p=>{p==="FFMPEG_END"&&m!==null&&(m(),m=null,h=!1)},q=({type:p,message:v})=>{T(p,v),ht(v,d),x(v)},I=()=>P($e,null,function*(){if(T("info","load ffmpeg-core"),c===null){T("info","loading ffmpeg-core");let{createFFmpegCore:p,corePath:v,workerPath:w,wasmPath:j}=yield gt(f);c=yield p({mainScriptUrlOrBlob:v,printErr:O=>q({type:"fferr",message:O}),print:O=>q({type:"ffout",message:O}),locateFile:(O,_)=>{if(typeof window!="undefined"){if(typeof j!="undefined"&&O.endsWith("ffmpeg-core.wasm"))return j;if(typeof w!="undefined"&&O.endsWith("ffmpeg-core.worker.js"))return w}return _+O}}),g=c.cwrap("proxy_main","number",["number","number"]),T("info","ffmpeg-core loaded")}else throw Error("ffmpeg.wasm was loaded, you should not load it again, use ffmpeg.isLoaded() to check next time.")}),J=()=>c!==null,W=(...p)=>{if(T("info",`run ffmpeg command: ${p.join(" ")}`),c===null)throw pe;if(h)throw Error("ffmpeg.wasm can only run one command at a time");return h=!0,new Promise(v=>{let w=[...ut,...p].filter(j=>j.length!==0);m=v,g(...mt(c,w))})},R=(p,...v)=>{if(T("info",`run FS.${p} ${v.map(w=>typeof w=="string"?w:`<${w.length} bytes binary file>`).join(" ")}`),c===null)throw pe;{let w=null;try{w=c.FS[p](...v)}catch(j){throw Error(p==="readdir"?`ffmpeg.FS('readdir', '${v[0]}') error. Check if the path exists, ex: ffmpeg.FS('readdir', '/')`:p==="readFile"?`ffmpeg.FS('readFile', '${v[0]}') error. Check if the path exists`:"Oops, something went wrong in FS operation.")}return w}},F=()=>{if(c===null)throw pe;h=!1,c.exit(1),c=null,g=null,m=null},B=p=>{d=p},U=p=>{Ne(p)};return Ge(i),Ne(o),T("info",`use ffmpeg.wasm v${vt}`),{setProgress:B,setLogger:U,setLogging:Ge,load:I,isLoaded:J,run:W,exit:F,FS:R}}});var We=L((_t,Ie)=>{we();var wt=xe(),{fetchFile:yt}=ue();Ie.exports={createFFmpeg:wt,fetchFile:yt}});var bt=L(Ye=>{var V=Xe(We());console.log(2);var A=(0,V.createFFmpeg)({log:!0}),z=document.getElementById("fileInput"),De=document.getElementById("convertButton"),M=document.getElementById("output");if(!z||!De||!M)throw console.error("\u5FC5\u8981\u306ADOM\u8981\u7D20\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093\u3002"),new Error("\u5FC5\u8981\u306ADOM\u8981\u7D20\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093\u3002");De.addEventListener("click",()=>P(Ye,null,function*(){if(!z.files||z.files.length===0){alert("MP3\u30D5\u30A1\u30A4\u30EB\u3092\u9078\u629E\u3057\u3066\u304F\u3060\u3055\u3044\u3002");return}let t=z.files[0];M.textContent="\u5909\u63DB\u4E2D...",A.isLoaded()||(yield A.load()),A.FS("writeFile","input.mp3",yield(0,V.fetchFile)(t));let i="";A.setLogger(({type:o,message:a})=>{(o==="fferr"||o==="ffout")&&(i+=a+`
`)});try{yield A.run("-i","input.mp3","-filter_complex","astats=metadata=1:reset=1","-f","null","-"),M.textContent="FFT\u89E3\u6790\u5B8C\u4E86\uFF01";let o=A.FS("readFile","output.txt"),a=new Blob([o.buffer],{type:"text/plain"}),f=URL.createObjectURL(a),c=document.createElement("a");c.href=f,c.download="frequency_analysis.txt",c.textContent="FFT\u7D50\u679C\u3092\u30C0\u30A6\u30F3\u30ED\u30FC\u30C9",M.appendChild(c)}catch(o){M.textContent="\u5909\u63DB\u4E2D\u306B\u30A8\u30E9\u30FC\u304C\u767A\u751F\u3057\u307E\u3057\u305F\u3002",console.error("FFmpeg error:",o),console.error("FFmpeg log:",i)}}))});bt();})();
//# sourceMappingURL=main.js.map
