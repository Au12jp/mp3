"use strict";(()=>{var Z=Object.defineProperty;var x=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var M=t=>{throw TypeError(t)};var ee=(t,e,r)=>e in t?Z(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var k=(t,e)=>{var r={};for(var a in t)q.call(t,a)&&e.indexOf(a)<0&&(r[a]=t[a]);if(t!=null&&x)for(var a of x(t))e.indexOf(a)<0&&Q.call(t,a)&&(r[a]=t[a]);return r};var h=(t,e)=>()=>(t&&(e=t(t=0)),e);var te=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var E=(t,e,r)=>ee(t,typeof e!="symbol"?e+"":e,r),C=(t,e,r)=>e.has(t)||M("Cannot "+r);var s=(t,e,r)=>(C(t,e,"read from private field"),r?r.call(t):e.get(t)),m=(t,e,r)=>e.has(t)?M("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),g=(t,e,r,a)=>(C(t,e,"write to private field"),a?a.call(t,r):e.set(t,r),r);var I=(t,e,r)=>new Promise((a,n)=>{var i=d=>{try{l(r.next(d))}catch(D){n(D)}},u=d=>{try{l(r.throw(d))}catch(D){n(D)}},l=d=>d.done?a(d.value):Promise.resolve(d.value).then(i,u);l((r=r.apply(t,e)).next())});var re,ie,o,S=h(()=>{re="0.12.6",ie=`https://unpkg.com/@ffmpeg/core@${re}/dist/umd/ffmpeg-core.js`;(function(t){t.LOAD="LOAD",t.EXEC="EXEC",t.WRITE_FILE="WRITE_FILE",t.READ_FILE="READ_FILE",t.DELETE_FILE="DELETE_FILE",t.RENAME="RENAME",t.CREATE_DIR="CREATE_DIR",t.LIST_DIR="LIST_DIR",t.DELETE_DIR="DELETE_DIR",t.ERROR="ERROR",t.DOWNLOAD="DOWNLOAD",t.PROGRESS="PROGRESS",t.LOG="LOG",t.MOUNT="MOUNT",t.UNMOUNT="UNMOUNT"})(o||(o={}))});var P,j=h(()=>{P=(()=>{let t=0;return()=>t++})()});var de,B,v,fe,W=h(()=>{de=new Error("unknown message type"),B=new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),v=new Error("called FFmpeg.terminate()"),fe=new Error("failed to import ffmpeg-core.js")});var F,f,w,R,L,O,N,c,y,$=h(()=>{S();j();W();F={},y=class{constructor(){m(this,f,null);m(this,w,{});m(this,R,{});m(this,L,[]);m(this,O,[]);E(this,"loaded",!1);m(this,N,()=>{s(this,f)&&(s(this,f).onmessage=({data:{id:e,type:r,data:a}})=>{switch(r){case o.LOAD:this.loaded=!0,s(this,w)[e](a);break;case o.MOUNT:case o.UNMOUNT:case o.EXEC:case o.WRITE_FILE:case o.READ_FILE:case o.DELETE_FILE:case o.RENAME:case o.CREATE_DIR:case o.LIST_DIR:case o.DELETE_DIR:s(this,w)[e](a);break;case o.LOG:s(this,L).forEach(n=>n(a));break;case o.PROGRESS:s(this,O).forEach(n=>n(a));break;case o.ERROR:s(this,R)[e](a);break}delete s(this,w)[e],delete s(this,R)[e]})});m(this,c,({type:e,data:r},a=[],n)=>s(this,f)?new Promise((i,u)=>{let l=P();s(this,f)&&s(this,f).postMessage({id:l,type:e,data:r},a),s(this,w)[l]=i,s(this,R)[l]=u,n==null||n.addEventListener("abort",()=>{u(new DOMException(`Message # ${l} was aborted`,"AbortError"))},{once:!0})}):Promise.reject(B));E(this,"load",(n={},{signal:a}={})=>{var i=n,{classWorkerURL:e}=i,r=k(i,["classWorkerURL"]);return s(this,f)||(g(this,f,e?new Worker(new URL(e,F.url),{type:"module"}):new Worker(new URL("./worker.js",F.url),{type:"module"})),s(this,N).call(this)),s(this,c).call(this,{type:o.LOAD,data:r},void 0,a)});E(this,"exec",(e,r=-1,{signal:a}={})=>s(this,c).call(this,{type:o.EXEC,data:{args:e,timeout:r}},void 0,a));E(this,"terminate",()=>{let e=Object.keys(s(this,R));for(let r of e)s(this,R)[r](v),delete s(this,R)[r],delete s(this,w)[r];s(this,f)&&(s(this,f).terminate(),g(this,f,null),this.loaded=!1)});E(this,"writeFile",(e,r,{signal:a}={})=>{let n=[];return r instanceof Uint8Array&&n.push(r.buffer),s(this,c).call(this,{type:o.WRITE_FILE,data:{path:e,data:r}},n,a)});E(this,"mount",(e,r,a)=>{let n=[];return s(this,c).call(this,{type:o.MOUNT,data:{fsType:e,options:r,mountPoint:a}},n)});E(this,"unmount",e=>{let r=[];return s(this,c).call(this,{type:o.UNMOUNT,data:{mountPoint:e}},r)});E(this,"readFile",(e,r="binary",{signal:a}={})=>s(this,c).call(this,{type:o.READ_FILE,data:{path:e,encoding:r}},void 0,a));E(this,"deleteFile",(e,{signal:r}={})=>s(this,c).call(this,{type:o.DELETE_FILE,data:{path:e}},void 0,r));E(this,"rename",(e,r,{signal:a}={})=>s(this,c).call(this,{type:o.RENAME,data:{oldPath:e,newPath:r}},void 0,a));E(this,"createDir",(e,{signal:r}={})=>s(this,c).call(this,{type:o.CREATE_DIR,data:{path:e}},void 0,r));E(this,"listDir",(e,{signal:r}={})=>s(this,c).call(this,{type:o.LIST_DIR,data:{path:e}},void 0,r));E(this,"deleteDir",(e,{signal:r}={})=>s(this,c).call(this,{type:o.DELETE_DIR,data:{path:e}},void 0,r))}on(e,r){e==="log"?s(this,L).push(r):e==="progress"&&s(this,O).push(r)}off(e,r){e==="log"?g(this,L,s(this,L).filter(a=>a!==r)):e==="progress"&&g(this,O,s(this,O).filter(a=>a!==r))}};f=new WeakMap,w=new WeakMap,R=new WeakMap,L=new WeakMap,O=new WeakMap,N=new WeakMap,c=new WeakMap});var G=h(()=>{$()});var Y,H,X=h(()=>{Y=new Error("failed to get response body reader"),H=new Error("failed to complete download")});var V,z=h(()=>{V="Content-Length"});var ae,A,J=h(()=>{X();z();ae=(t,e)=>I(void 0,null,function*(){var n;let r=yield fetch(t),a;try{let i=parseInt(r.headers.get(V)||"-1"),u=(n=r.body)==null?void 0:n.getReader();if(!u)throw Y;let l=[],d=0;for(;;){let{done:_,value:U}=yield u.read(),b=U?U.length:0;if(_){if(i!=-1&&i!==d)throw H;e&&e({url:t,total:i,received:d,delta:b,done:_});break}l.push(U),d+=b,e&&e({url:t,total:i,received:d,delta:b,done:_})}let D=new Uint8Array(d),T=0;for(let _ of l)D.set(_,T),T+=_.length;a=D.buffer}catch(i){console.log("failed to send download progress event: ",i),a=yield r.arrayBuffer(),e&&e({url:t,total:a.byteLength,received:a.byteLength,delta:0,done:!0})}return a}),A=(t,e,r=!1,a)=>I(void 0,null,function*(){let n=r?yield ae(t,a):yield(yield fetch(t)).arrayBuffer(),i=new Blob([n],{type:e});return URL.createObjectURL(i)})});var oe=te(K=>{G();J();var p=null;self.addEventListener("message",t=>I(K,null,function*(){let{command:e,args:r}=t.data;switch(e){case"load":yield se();break;case"writeFile":p&&(yield p.writeFile(r[0],r[1]),self.postMessage({status:"file-written"}));break;case"readFile":if(p){let a=yield p.readFile(r[0]);self.postMessage({result:a})}break;case"run":p&&(yield p.exec(r),self.postMessage({status:"execution-completed"}));break;default:console.error(`Unknown command: ${e}`)}}));function se(){return I(this,null,function*(){try{if(p===null){p=new y;let t="./core-mt",e={classWorkerURL:yield A(`${t}/worker.js`,"text/javascript"),coreURL:yield A(`${t}/ffmpeg-core.js`,"text/javascript"),wasmURL:yield A(`${t}/ffmpeg-core.wasm`,"application/wasm"),workerURL:yield A(`${t}/ffmpeg-core.worker.js`,"text/javascript")};yield p.load(e),self.postMessage({status:"loaded"})}else self.postMessage({status:"already-loaded"})}catch(t){self.postMessage({status:"error",message:t})}})}});oe();})();
//# sourceMappingURL=worker.js.map
